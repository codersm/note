---
title: Redis入门系列——初识Redis
date: 2016-10-30 21:03:28
tags: Redis
---
# Redis入门系列——初识Redis

## Redis简介

Redis是一种基于键值对（key-value）的NoSQL数据库，与很多键值对数据库不同的是，Redis中的值可以是由string（字符串）、hash（哈希）、list（列表）、zset（有序集合）、Bitmaps（位图）、HyperLoglog、GEO（地理信息定位）等多种数据结构和算法组成，因此Redis可以满足很多的应用场景。Redis将所有数据都存储在内存中，所以它的读写性能强劲；另外Redis拥有两种不同形式的持久化方法，可以将存储在内存中的数据写入磁盘。除此之外，Redis还提供了键过期、发布订阅、事务、PipeLine、Lua脚本等附加功能。

### Redis与memcached的比较

两者都可用于存储键值映射，彼此的性能也相差无几，但是Redis能够自动以两种不同的方式将数据写入磁盘，并且Redis除了能存储普通字符串之外，还可以存储其他数据结构，而memcached只能存储普通的字符串键，这些不同之处使得Redis可以用于解决更为广泛的问题。


### Redis版本说明

Redis借鉴了Linux操作系统对于版本号的命名规则：版本号第二位如果是奇数，则为非稳定版本（例如2.7、2.9、3.1），如果是偶数，则为稳定版本（例如2.6、2.8、3.0、3.2）。当前奇数版本就是下一个稳定版本的开发版本，例如2.9版本是3.0版本的开发版本。所以我们在生产环境通常选取偶数版本的Redis。

## Redis命令

### 全局命令

### 数据结构和内部编码

实际上每种数据结构都有自己底层的内部编码实现，而且是多种实现，这样Redis会在合适的场景选择合适的内部编码，如下图所示：


每种数据结构都有两种以上的内部编码实现，例如list数据结构包含了linkedlist和ziplist两种内部编码。同时有些内部编码，例如ziplist可以作为多种外部数据结构的内部实现，可以通过`object encoding`命令查询内部编码。

Redis这样设计有两个好处：

* 可以改进内部编码，而对外的数据结构和命令没有影响，这样一旦开发出更优秀的内部编码，无需改动外部数据结构和命令。

* 多种内部编码实现可以在不同场景下发挥各自的优势，例如ziplist比较节省内存，但是在列表元素比较多的情况下，性能会所有下降，这时候Redis会根据配置选项将列表类型的内部实现转换为linkedlist。


### 单线程架构

Redis使用了单线程架构和I／O多路复用模型来实现高性能的内存数据库服务。

Redis是单线程来处理命令的，所以一条命令从客户端达到服务端不会立刻被执行，所有命令都会进入一个队列中，然会逐个执行。

为什么Redis使用单线程模型会达到每秒万级别的处理能力呢？

1、纯内存访问，Redis将所有数据放在内存中，内存响应时长大约为100纳秒，这是Redis达到每秒万级别访问的重要基础。

2、非阻塞I／O，Redis使用epoll作为I／O多路复用技术的实现，再加上Redis自身的事件处理模型将epoll中的连接、读写、关闭都转换为事件，不在网络I／O上浪费过多的时间。

3、单线程避免了线程切换和竞态产生的消耗。

但是单线程会有一个问题：对于每个命令的执行时间是有要求的。如果某个命令执行过长，会造成其他命令的阻塞，对于Redis这种高性能的服务器说是致命的，所以Redis是面向快速执行场景的数据库。

### 字符串

字符串类型是Redis最基础的数据结构。首先键都是字符串类型，而且其他几种数据结构都是在字符串类型基础上构建的。字符串类型的值实际可以是字符串（简单的字符串、复杂的字符串（JSON、XML））、数字，甚至是二进制（图片、音频、视频），但是值最大不能超过512MB。

1、常用命令

2、

如果键名比较长，可以在能描述键含义的前提下适当减少键的长度，从而减少由于键过长的内存浪费。

### 哈希





